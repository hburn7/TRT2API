## The Roundtable II API
This API is used by The Roundtable II website & gosumemory stream overlay. This API functions as a bridge between these services and a central PostgreSQL database.

## Usage
Setup is straightforward.

* Clone the repository: ```git clone https://github.com/hburn7/TRT2API.git && cd TRT2API```
* Run the project via the dotnet CLI (note, CD to the folder containing the `.csproj` file): `cd TRT2API && dotnet run`
* Configure a PostgreSQL database and update the connection string in `appsettings.json` (replace values in example appsettings.json)
* Run the provided database scripts to create the necessary tables
* Query an endpoint on the running port: `GET https://localhost:44395/api/players/all` for example

# Database
Run the db.sql script into your PostgreSQL instance. This will create the necessary tables for the API to function.

# API Endpoints

All responses are provided in JSON format.

## Players Endpoints

* **Get All Players:** `GET /api/players/all` 
    - Returns all players in the database. If no players exist, a 404 error is returned.

* **Get Player by ID:** `GET /api/players/{playerID}`
    - Returns a specific player by their ID. If no player exists with the provided ID, a 404 error is returned.

* **Get Player Matches:** `GET /api/players/{playerID}/matches`
    - Returns all matches a specific player has participated in. If no matches exist for the player, a 404 error is returned.

## Matches Endpoints

* **Get All Matches:** `GET /api/matches/all` 
    - Returns all matches in the database. If no matches exist, a 404 error is returned.

* **Get Match by ID:** `GET /api/matches/{matchID}` 
    - Returns a specific match by its ID. If no match exists with the provided ID, a 404 error is returned.

* **Get Match Players:** `GET /api/matches/{matchID}/players` 
    - Returns all players involved in a specific match. If no match exists with the provided ID, a 404 error is returned.

## POST Methods

* **Add Player:** `POST /api/players/add` 
    - Adds a new player to the database. The request body must contain a JSON object representing the player (without an "id" property as it is auto-generated by the database). If the player already exists, a 409 error is returned.

* **Update Player:** `POST /api/players/update`
    - Updates an existing player's data in the database. The request body should contain a JSON object representing the player, similar to the Add Player method. If the player does not exist, a 404 error is returned.

Note: Both Add and Update Player return the number of affected rows (0 indicates failure, 1 indicates success).

JSON sample for Add and Update Player:
```json
{
  "playerID": 123,
  "playerName": "JohnDoe",
  "totalWins": 0,
  "totalLosses": 0,
  "status": "some status",
  "isEliminated": false
}
```

Remember: successful operations return HTTP status code 200 unless otherwise noted.
